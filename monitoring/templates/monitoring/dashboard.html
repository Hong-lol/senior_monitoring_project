{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>노인 안전 모니터링 시스템</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
    <div class="container">
        <!-- 사이드바 -->
        <div class="sidebar">
            <div class="system-logo">
                <span class="logo-text">안전 모니터링</span>
            </div>
            <h2>모니터링 대상</h2>
            <ul class="person-list">
                {% for person in people %}
                <li class="person-item">
                    <button class="person-btn {{ person.status }} {% if forloop.first %}active{% endif %}" 
                            data-person-id="{{ person.id }}" 
                            onclick="showPerson('{{ person.id }}')">
                        <span class="person-name">{{ person.name }}</span>
                        <span class="person-info">{{ person.age }}세 | 위치: {{ person.location }}</span>
                    </button>
                    <div class="status-indicator status-{{ person.status }}"></div>
                </li>
                {% endfor %}
            </ul>
        </div>

        <!-- 메인 콘텐츠 -->
        <div class="main-content">
            <div class="main-header">
                <h1 class="page-title">노인 안전 모니터링 시스템</h1>
                <div class="current-time" id="current-time">00:00:00</div>
            </div>

            {% for person in people %}
            <div id="person{{ person.id }}" class="dashboard {% if forloop.first %}active{% endif %}">
                <div class="person-header">
                    <div class="person-title">
                        <h2>{{ person.name }}</h2>
                        <p>{{ person.age }}세 | 현재 위치: {{ person.location }}</p>
                    </div>
                    {% if person.status == 'danger' %}
                    <button class="emergency-btn">긴급 지원 호출</button>
                    {% endif %}
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">심박수</div>
                        <div class="stat-value">{{ person.heart_rate }} BPM</div>
                        <div class="stat-status status-{{ person.heart_rate|yesno:'danger,warning,normal' }}">
                            {% if person.heart_rate > 90 %}심박수 높음
                            {% elif person.heart_rate < 70 %}심박수 낮음
                            {% else %}정상 범위{% endif %}
                        </div>
                    </div>

                    <div class="stat-card activity-status-card" data-person-id="{{ person.id }}">
                        <div class="stat-title">활동 상태</div>
                        <div class="stat-value">{{ person.activity_status }}</div>
                        <div class="stat-status activity-status-text status-{{ person.status }}">
                            {% if person.status == 'normal' %}정상 활동 중
                            {% elif person.status == 'warning' %}주의 필요
                            {% else %}즉시 확인 필요{% endif %}
                        </div>
                    </div>




                    <div class="stat-card">
                        <div class="stat-title">체온</div>
                        <div class="stat-value">{{ person.temperature }} °C</div>
                        <div class="stat-status status-{% if person.temperature > 37.5 %}warning{% else %}normal{% endif %}">
                            {% if person.temperature > 37.5 %}체온 높음{% else %}정상 범위{% endif %}
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-title">실내 습도</div>
                        <div class="stat-value">{{ person.humidity }} %</div>
                        <div class="stat-status status-normal">적정 습도</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="alert-list"></div>

    </div>

    
    <script>
  window.peopleData = [
    {% for person in people %}
      {
        id: {{ person.id }},
        name: "{{ person.name }}",
        age: {{ person.age }},
        location: "{{ person.location }}",
        status: "{{ person.status }}",
        heart_rate: {{ person.heart_rate }},
        activity_status: "{{ person.activity_status }}",
        temperature: {{ person.temperature }},
        humidity: {{ person.humidity }}
      }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ];
</script>

<script src="{% static 'js/dashboard.js' %}"></script>
</body>
</html>
